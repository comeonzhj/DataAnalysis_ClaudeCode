<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电商数据分析报告</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        .slide-container {
            display: none;
            width: 100%;
            height: 100vh;
            padding: 2rem;
            box-sizing: border-box;
        }
        .slide-container.active {
            display: block;
        }
        .slide-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        .slide-title {
            font-size: 2.5rem;
            color: #1e293b;
            margin-bottom: 1rem;
        }
        .slide-subtitle {
            font-size: 1.2rem;
            color: #64748b;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .metric-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
            text-align: center;
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #10b981;
            margin-bottom: 0.5rem;
        }
        .metric-label {
            color: #64748b;
            font-size: 0.9rem;
        }
        .chart-container {
            width: 100%;
            height: 400px;
            margin: 2rem 0;
        }
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }
        .content-section {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1.5rem;
        }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
        }
        .insights-list {
            list-style: none;
            padding: 0;
        }
        .insights-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e2e8f0;
            color: #475569;
        }
        .insights-list li:last-child {
            border-bottom: none;
        }
        .slide-navigation {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            gap: 1rem;
        }
        .nav-btn {
            padding: 0.5rem 1rem;
            background: #10b981;
            color: white;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .nav-btn:hover {
            background: #059669;
        }
        .nav-btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            .metrics-grid {
                grid-template-columns: 1fr 1fr;
            }
            .slide-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body class="slide-page">
    <!-- 封面页 -->
    <div class="slide-container active">
        <div class="slide" style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%;">
            <div class="slide-header">
                <h1 class="slide-title">电商数据分析报告</h1>
                <p class="slide-subtitle">2025年1-6月业务数据深度洞察</p>
            </div>
            <div style="margin-top: 3rem; text-align: center; color: #64748b;">
                <p>报告生成时间：2025年9月</p>
                <p>数据周期：2025年1月-6月</p>
            </div>
        </div>
    </div>

    <!-- 业务概览页 -->
    <div class="slide-page">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">业务概览</h1>
                <p class="slide-subtitle">关键指标总览</p>
            </div>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">1,000</div>
                    <div class="metric-label">总订单数</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">196,185</div>
                    <div class="metric-label">总销售额（元）</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">196.19</div>
                    <div class="metric-label">平均客单价（元）</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">54.0%</div>
                    <div class="metric-label">退款率</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">50</div>
                    <div class="metric-label">商品种类数</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">33</div>
                    <div class="metric-label">覆盖地区数</div>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">关键发现</h3>
                <ul class="insights-list">
                    <li>• 总订单数达到1,000单，总销售额196,185.01元，平均客单价196.19元</li>
                    <li>• 退款率高达54%，需要重点关注商品质量和服务体验</li>
                    <li>• 业务覆盖全国33个地区，商品种类丰富（50种）</li>
                    <li>• 优惠券使用率达到100%，促销策略效果显著</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 时间趋势页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">时间趋势分析</h1>
                <p class="slide-subtitle">月度订单和销售额趋势</p>
            </div>
            <div class="chart-container" id="temporalChart"></div>
            <div class="content-section">
                <h3 class="section-title">趋势洞察</h3>
                <ul class="insights-list">
                    <li>• 订单量最高月份：2025年3月（182单）</li>
                    <li>• 销售额最高月份：2025年2月（36,156元）</li>
                    <li>• 3月份订单量环比增长10.3%，但销售额环比下降12.3%</li>
                    <li>• 5月份订单量和销售额均出现显著回升</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 商品分析页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">商品分析</h1>
                <p class="slide-subtitle">TOP商品排行和表现</p>
            </div>
            <div class="two-column">
                <div>
                    <h3 class="section-title">热销TOP3商品（按订单量）</h3>
                    <div class="chart-container" id="productOrdersChart" style="height: 300px;"></div>
                </div>
                <div>
                    <h3 class="section-title">高销售额TOP3商品</h3>
                    <div class="chart-container" id="productSalesChart" style="height: 300px;"></div>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">商品表现洞察</h3>
                <ul class="insights-list">
                    <li>• TOP3热销商品：SKU033（28单）、SKU009（27单）、SKU005（27单）</li>
                    <li>• TOP3高销售额商品：SKU041（20,854元）、SKU003（17,350元）、SKU033（7,737元）</li>
                    <li>• 高价值商品SKU041平均单价达595.83元，但退款率高达72.2%</li>
                    <li>• 热销商品SKU009单价仅10.26元，退款率40.7%，性价比突出</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 优惠券效果页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">优惠券效果分析</h1>
                <p class="slide-subtitle">优惠券使用情况分析</p>
            </div>
            <div class="two-column">
                <div>
                    <div class="chart-container" id="couponChart"></div>
                </div>
                <div class="content-section">
                    <h3 class="section-title">优惠券使用分布</h3>
                    <ul class="insights-list">
                        <li>• 免邮券：211次使用（21.1%）</li>
                        <li>• 满100减10：208次使用（20.8%）</li>
                        <li>• 无优惠：198次（19.8%）</li>
                        <li>• 全场8折：192次使用（19.2%）</li>
                        <li>• 新人专享券：191次使用（19.1%）</li>
                    </ul>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">优惠券效果洞察</h3>
                <ul class="insights-list">
                    <li>• 总优惠券使用率达到80.2%，促销策略效果显著</li>
                    <li>• 免邮券和满减券最受欢迎，合计占比41.9%</li>
                    <li>• 满100减10优惠券ROI达136.2%，是最优促销方式</li>
                    <li>• 建议优化优惠券结构，提高高价值优惠券使用率</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 地区分布页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">地区分布分析</h1>
                <p class="slide-subtitle">地区订单和销售额分布</p>
            </div>
            <div class="chart-container" id="regionChart"></div>
            <div class="content-section">
                <h3 class="section-title">地区表现洞察</h3>
                <ul class="insights-list">
                    <li>• TOP3订单地区：北京（104单）、上海（101单）、浙江（96单）</li>
                    <li>• TOP3客单价地区：天津（669.95元）、四川（411.65元）、澳门（323.68元）</li>
                    <li>• 北京地区销售额最高（31,914元），占总销售额的16.3%</li>
                    <li>• 天津地区客单价最高，但订单量相对较少（21单）</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 价格分析页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">价格分析</h1>
                <p class="slide-subtitle">价格分布和特征</p>
            </div>
            <div class="two-column">
                <div>
                    <div class="chart-container" id="priceDistChart"></div>
                </div>
                <div class="content-section">
                    <h3 class="section-title">价格分布统计</h3>
                    <ul class="insights-list">
                        <li>• 单价中位数：45.63元</li>
                        <li>• 订单金额中位数：138.78元</li>
                        <li>• 25-50元价位订单最多（384单，38.4%）</li>
                        <li>• 50-100元价位贡献最多销售额（97,699元，49.8%）</li>
                        <li>• 500元以上高价值订单占比1.8%，贡献10.6%销售额</li>
                    </ul>
                </div>
            </div>
            <div class="content-section">
                <h3 class="section-title">价格洞察</h3>
                <ul class="insights-list">
                    <li>• 主要价格集中在25-100元区间，占总订单量的77.9%</li>
                    <li>• 高价值商品（500元以上）虽然订单量少，但客单价高</li>
                    <li>• 各价位段退款率差异明显，需要针对性优化</li>
                    <li>• 建议加强中等价位商品（50-100元）的推广</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- 总结页 -->
    <div class="slide-container">
        <div class="slide">
            <div class="slide-header">
                <h1 class="slide-title">总结与建议</h1>
                <p class="slide-subtitle">关键发现和建议</p>
            </div>
            <div class="two-column">
                <div class="content-section">
                    <h3 class="section-title">关键发现</h3>
                    <ul class="insights-list">
                        <li>• 业务规模：半年内完成1,000单，销售额19.6万元</li>
                        <li>• 退款问题：整体退款率54%，损失10.6万元</li>
                        <li>• 地区差异：一线城市订单集中，部分地区客单价高</li>
                        <li>• 商品表现：热销商品与高价值商品存在差异</li>
                        <li>• 价格策略：中低价位商品是销售主力</li>
                    </ul>
                </div>
                <div class="content-section">
                    <h3 class="section-title">改进建议</h3>
                    <ul class="insights-list">
                        <li>• 紧急降低退款率：优化商品质量控制和售后服务</li>
                        <li>• 差异化运营：针对不同地区制定个性化策略</li>
                        <li>• 商品结构优化：平衡热销商品与高价值商品</li>
                        <li>• 价格策略调整：加强50-100元价位商品推广</li>
                        <li>• 优惠券优化：提高高ROI优惠券的使用比例</li>
                    </ul>
                </div>
            </div>
            <div class="content-section" style="margin-top: 2rem;">
                <h3 class="section-title">下一步行动计划</h3>
                <ul class="insights-list">
                    <li>• 1个月内：建立退款预警机制，目标退款率降至40%以下</li>
                    <li>• 2个月内：优化商品组合，提高高价值商品销售占比</li>
                    <li>• 3个月内：完善地区化运营策略，提升整体客单价</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="slide-navigation">
        <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">上一页</button>
        <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">下一页</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide-container');
        const totalSlides = slides.length;

        function showSlide(n) {
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');

            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;

            // 初始化当前页面的图表
            initChartsForSlide(currentSlide);
        }

        function changeSlide(direction) {
            if (direction === 1 && currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
            } else if (direction === -1 && currentSlide > 0) {
                showSlide(currentSlide - 1);
            }
        }

        function initChartsForSlide(slideIndex) {
            switch(slideIndex) {
                case 2: // 时间趋势页
                    initTemporalChart();
                    break;
                case 3: // 商品分析页
                    initProductCharts();
                    break;
                case 4: // 优惠券页
                    initCouponChart();
                    break;
                case 5: // 地区分布页
                    initRegionChart();
                    break;
                case 6: // 价格分析页
                    initPriceChart();
                    break;
            }
        }

        function initTemporalChart() {
            const chart = echarts.init(document.getElementById('temporalChart'));
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross'
                    }
                },
                legend: {
                    data: ['订单量', '销售额']
                },
                xAxis: {
                    type: 'category',
                    data: ['2025-01', '2025-02', '2025-03', '2025-04', '2025-05', '2025-06']
                },
                yAxis: [
                    {
                        type: 'value',
                        name: '订单量',
                        position: 'left'
                    },
                    {
                        type: 'value',
                        name: '销售额（元）',
                        position: 'right'
                    }
                ],
                series: [
                    {
                        name: '订单量',
                        type: 'bar',
                        data: [160, 165, 182, 149, 179, 165],
                        itemStyle: {
                            color: '#10b981'
                        }
                    },
                    {
                        name: '销售额',
                        type: 'line',
                        yAxisIndex: 1,
                        data: [32898.51, 36155.7, 31696.36, 29209.45, 34926.26, 31298.73],
                        itemStyle: {
                            color: '#3b82f6'
                        }
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initProductCharts() {
            // 热销商品图表
            const ordersChart = echarts.init(document.getElementById('productOrdersChart'));
            const ordersOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                xAxis: {
                    type: 'category',
                    data: ['SKU033', 'SKU009', 'SKU005']
                },
                yAxis: {
                    type: 'value',
                    name: '订单量'
                },
                series: [{
                    type: 'bar',
                    data: [28, 27, 27],
                    itemStyle: {
                        color: '#10b981'
                    }
                }]
            };
            ordersChart.setOption(ordersOption);

            // 高销售额商品图表
            const salesChart = echarts.init(document.getElementById('productSalesChart'));
            const salesOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: function(params) {
                        return params[0].name + '<br/>销售额: ¥' + params[0].value.toLocaleString();
                    }
                },
                xAxis: {
                    type: 'category',
                    data: ['SKU041', 'SKU003', 'SKU033']
                },
                yAxis: {
                    type: 'value',
                    name: '销售额（元）'
                },
                series: [{
                    type: 'bar',
                    data: [20854.05, 17349.78, 7736.8],
                    itemStyle: {
                        color: '#f59e0b'
                    }
                }]
            };
            salesChart.setOption(salesOption);

            window.addEventListener('resize', () => {
                ordersChart.resize();
                salesChart.resize();
            });
        }

        function initCouponChart() {
            const chart = echarts.init(document.getElementById('couponChart'));
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left'
                },
                series: [{
                    name: '优惠券使用',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '20',
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        {value: 211, name: '免邮券', itemStyle: {color: '#10b981'}},
                        {value: 208, name: '满100减10', itemStyle: {color: '#3b82f6'}},
                        {value: 198, name: '无优惠', itemStyle: {color: '#94a3b8'}},
                        {value: 192, name: '全场8折', itemStyle: {color: '#f59e0b'}},
                        {value: 191, name: '新人专享券', itemStyle: {color: '#8b5cf6'}}
                    ]
                }]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initRegionChart() {
            const chart = echarts.init(document.getElementById('regionChart'));
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['订单量', '客单价']
                },
                xAxis: {
                    type: 'category',
                    data: ['北京', '上海', '浙江', '福建', '江苏', '广东', '山东', '天津']
                },
                yAxis: [
                    {
                        type: 'value',
                        name: '订单量',
                        position: 'left'
                    },
                    {
                        type: 'value',
                        name: '客单价（元）',
                        position: 'right'
                    }
                ],
                series: [
                    {
                        name: '订单量',
                        type: 'bar',
                        data: [104, 101, 96, 85, 69, 67, 65, 21],
                        itemStyle: {
                            color: '#10b981'
                        }
                    },
                    {
                        name: '客单价',
                        type: 'line',
                        yAxisIndex: 1,
                        data: [306.87, 190.77, 138.84, 136.17, 132.55, 106.13, 182.16, 669.95],
                        itemStyle: {
                            color: '#ef4444'
                        }
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        function initPriceChart() {
            const chart = echarts.init(document.getElementById('priceDistChart'));
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['订单数', '销售额占比']
                },
                xAxis: {
                    type: 'category',
                    data: ['0-25', '25-50', '50-100', '200-300', '300-500', '500+']
                },
                yAxis: [
                    {
                        type: 'value',
                        name: '订单数',
                        position: 'left'
                    },
                    {
                        type: 'value',
                        name: '销售额占比（%）',
                        position: 'right'
                    }
                ],
                series: [
                    {
                        name: '订单数',
                        type: 'bar',
                        data: [174, 384, 396, 10, 18, 18],
                        itemStyle: {
                            color: '#3b82f6'
                        }
                    },
                    {
                        name: '销售额占比',
                        type: 'line',
                        yAxisIndex: 1,
                        data: [5.8, 22.0, 49.8, 2.9, 8.8, 10.6],
                        itemStyle: {
                            color: '#f59e0b'
                        }
                    }
                ]
            };
            chart.setOption(option);
            window.addEventListener('resize', () => chart.resize());
        }

        // 初始化第一页的图表
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('prevBtn').disabled = true;
        });

        // 键盘导航
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                changeSlide(-1);
            } else if (e.key === 'ArrowRight') {
                changeSlide(1);
            }
        });
    </script>
</body>
</html>
