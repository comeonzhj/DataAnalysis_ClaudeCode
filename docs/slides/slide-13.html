<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投放效果分析</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body class="slide-page">
    <div class="slide">
        <div class="slide-header">
            <h1 class="slide-title">投放效果分析</h1>
            <p class="slide-subtitle">获客成本、LTV和ROI分析</p>
        </div>
        <div class="slide-content two-column">
            <div class="content-section">
                <h2 class="section-title">ROI与获客成本对比</h2>
                <div id="marketingEffectivenessChart" class="chart-container"></div>
            </div>
            <div class="content-section">
                <h2 class="section-title">投放效果排名</h2>
                <div class="metrics-grid">
                    <div class="metric-card success">
                        <h3>ROI最高</h3>
                        <p class="metric-value">1,308,851%</p>
                        <p class="metric-desc">北京地区</p>
                    </div>
                    <div class="metric-card">
                        <h3>获客成本最低</h3>
                        <p class="metric-value">￥0</p>
                        <p class="metric-desc">香港地区</p>
                    </div>
                    <div class="metric-card warning">
                        <h3>获客成本最高</h3>
                        <p class="metric-value">￥79.74</p>
                        <p class="metric-desc">澳门地区</p>
                    </div>
                    <div class="metric-card">
                        <h3>平均LTV</h3>
                        <p class="metric-value">￥45,000+</p>
                        <p class="metric-desc">TOP10地区</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // 营销效果图表
        const marketingEffectivenessChart = echarts.init(document.getElementById('marketingEffectivenessChart'));

        const marketingData = [
            {name: '北京', roi: 13088.51, ltv: 552444.10, cost: 42.3},
            {name: '上海', roi: 10690.13, ltv: 323832.10, cost: 30.3},
            {name: '浙江', roi: 7473.45, ltv: 212795.84, cost: 28.5},
            {name: '福建', roi: 6680.98, ltv: 163621.78, cost: 24.5},
            {name: '山东', roi: 4544.04, ltv: 127963.18, cost: 28.2},
            {name: '江苏', roi: 4028.19, ltv: 104877.82, cost: 26.0},
            {name: '广东', roi: 2985.69, ltv: 79106.72, cost: 26.5},
            {name: '天津', roi: 1839.07, ltv: 49147.88, cost: 26.7}
        ];

        const marketingEffectivenessOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                },
                formatter: function(params) {
                    let result = params[0].name + '<br/>';
                    params.forEach(param => {
                        if (param.seriesName === 'ROI') {
                            result += param.marker + param.seriesName + ': ' + param.value + '%<br/>';
                        } else if (param.seriesName === '获客成本') {
                            result += param.marker + param.seriesName + ': ￥' + param.value + '<br/>';
                        } else {
                            result += param.marker + param.seriesName + ': ￥' + param.value.toLocaleString() + '<br/>';
                        }
                    });
                    return result;
                }
            },
            legend: {
                data: ['ROI', 'LTV', '获客成本']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                top: '15%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: marketingData.map(item => item.name)
            },
            yAxis: [
                {
                    type: 'value',
                    name: 'ROI(%)',
                    position: 'left',
                    axisLabel: {
                        formatter: '{value}%'
                    }
                },
                {
                    type: 'value',
                    name: '金额(￥)',
                    position: 'right',
                    axisLabel: {
                        formatter: '￥{value}'
                    }
                }
            ],
            series: [
                {
                    name: 'ROI',
                    type: 'bar',
                    data: marketingData.map(item => item.roi),
                    itemStyle: {
                        color: '#10b981'
                    }
                },
                {
                    name: 'LTV',
                    type: 'line',
                    yAxisIndex: 1,
                    data: marketingData.map(item => item.ltv),
                    smooth: true,
                    itemStyle: {
                        color: '#3b82f6'
                    }
                },
                {
                    name: '获客成本',
                    type: 'line',
                    yAxisIndex: 1,
                    data: marketingData.map(item => item.cost),
                    smooth: true,
                    itemStyle: {
                        color: '#f59e0b'
                    }
                }
            ]
        };

        marketingEffectivenessChart.setOption(marketingEffectivenessOption);

        // 响应式处理
        window.addEventListener('resize', function() {
            marketingEffectivenessChart.resize();
        });
    </script>
</body>
</html>