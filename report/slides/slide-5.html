<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户行为影响 - 凑单行为与复购率分析</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body class="slide-page">
    <div class="slide">
        <div class="slide-header">
            <h1 class="slide-title">用户行为影响</h1>
            <p class="slide-subtitle">凑单行为、客单价提升与复购率分析</p>
        </div>

        <div class="slide-content">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                <div class="content-section">
                    <h2 class="section-title">凑单行为分析</h2>
                    <div class="chart-container" id="addToOrderChart" style="height: 300px;"></div>
                </div>

                <div class="content-section">
                    <h2 class="section-title">凑单金额与退款率</h2>
                    <div class="chart-container" id="addToOrderDetailChart" style="height: 300px;"></div>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">行为洞察</h3>
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-icon">🛒</div>
                        <div class="insight-content">
                            <h4>全场8折凑单率最高</h4>
                            <p>9.9%的用户会为了享受折扣而进行凑单，平均凑单金额78.9元</p>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">💰</div>
                        <div class="insight-content">
                            <h4>满100减10客单价提升最佳</h4>
                            <p>相比无优惠订单，客单价提升12.7%，达到183.7元</p>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🔄</div>
                        <div class="insight-content">
                            <h4>凑单退款率相对稳定</h4>
                            <p>各类型优惠券的凑单退款率均在52-54%之间，差异不大</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // 凑单行为分析图表
        const addToOrderChart = echarts.init(document.getElementById('addToOrderChart'));

        const addToOrderData = [
            { name: '无优惠', rate: 6.57, orders: 13 },
            { name: '免邮券', rate: 6.16, orders: 13 },
            { name: '满100减10', rate: 8.17, orders: 17 },
            { name: '新人专享券', rate: 8.90, orders: 17 },
            { name: '全场8折', rate: 9.90, orders: 19 }
        ];

        const addToOrderOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params) {
                    const data = params[0];
                    const orderData = addToOrderData.find(d => d.name === data.name);
                    return `<div style="padding: 10px;">
                        <strong>${data.name}</strong><br/>
                        凑单率: ${data.value}%<br/>
                        凑单订单数: ${orderData.orders}单
                    </div>`;
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: addToOrderData.map(d => d.name),
                axisLabel: {
                    interval: 0,
                    rotate: 45
                }
            },
            yAxis: {
                type: 'value',
                name: '凑单率 (%)'
            },
            series: [{
                name: '凑单率',
                type: 'bar',
                data: addToOrderData.map(d => ({
                    value: d.rate,
                    itemStyle: {
                        color: d.rate > 8 ? '#ef4444' : d.rate > 7 ? '#f59e0b' : '#10b981'
                    }
                })),
                label: {
                    show: true,
                    position: 'top',
                    formatter: '{c}%'
                }
            }]
        };

        addToOrderChart.setOption(addToOrderOption);

        // 凑单金额与退款率图表
        const addToOrderDetailChart = echarts.init(document.getElementById('addToOrderDetailChart'));

        const detailOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            legend: {
                data: ['平均凑单金额', '凑单退款率']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: ['无优惠', '免邮券', '满100减10', '新人专享券', '全场8折'],
                axisLabel: {
                    interval: 0,
                    rotate: 45
                }
            },
            yAxis: [
                {
                    type: 'value',
                    name: '凑单金额 (元)',
                    position: 'left'
                },
                {
                    type: 'value',
                    name: '退款率 (%)',
                    position: 'right',
                    axisLabel: {
                        formatter: '{value}%'
                    }
                }
            ],
            series: [
                {
                    name: '平均凑单金额',
                    type: 'bar',
                    data: [66.98, 65.51, 72.78, 75.11, 78.89],
                    itemStyle: { color: '#3b82f6' },
                    label: {
                        show: true,
                        position: 'top',
                        formatter: '¥{c}'
                    }
                },
                {
                    name: '凑单退款率',
                    type: 'line',
                    yAxisIndex: 1,
                    data: [53.8, 53.8, 52.9, 52.9, 52.6],
                    itemStyle: { color: '#ef4444' },
                    lineStyle: { width: 3 },
                    symbol: 'circle',
                    symbolSize: 8
                }
            ]
        };

        addToOrderDetailChart.setOption(detailOption);

        // 响应式处理
        window.addEventListener('resize', function() {
            addToOrderChart.resize();
            addToOrderDetailChart.resize();
        });
    </script>
</body>
</html>