<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROI重评估 - 考虑退款的精确ROI对比</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body class="slide-page">
    <div class="slide">
        <div class="slide-header">
            <h1 class="slide-title">ROI重评估</h1>
            <p class="slide-subtitle">考虑退款后的精确ROI对比分析</p>
        </div>

        <div class="slide-content">
            <div class="content-section">
                <h2 class="section-title">各优惠券类型ROI对比（考虑退款）</h2>
                <div class="chart-container" id="roiChart" style="height: 400px;"></div>
            </div>

            <div class="content-section">
                <h3 class="section-title">关键洞察</h3>
                <ul class="insights-list">
                    <li><strong>满100减10</strong>表现最佳，ROI达到41.0%，显著优于其他优惠券类型</li>
                    <li><strong>免邮券</strong>紧随其后，ROI为40.7%，与满减券效果相近</li>
                    <li><strong>全场8折</strong>和<strong>新人专享券</strong>出现负ROI，分别为-60.7%和-47.6%</li>
                    <li>高退款率（平均54%）显著影响了优惠券的真实效果</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // ROI对比图表
        const roiChart = echarts.init(document.getElementById('roiChart'));

        const roiData = [
            { name: '满100减10', value: 40.98, refundRate: 55.3 },
            { name: '免邮券', value: 40.66, refundRate: 51.7 },
            { name: '无优惠', value: 0, refundRate: 57.1 },
            { name: '新人专享券', value: -47.56, refundRate: 56.0 },
            { name: '全场8折', value: -60.66, refundRate: 50.0 }
        ];

        const option = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params) {
                    const data = params[0];
                    const refundRate = roiData.find(d => d.name === data.name).refundRate;
                    return `<div style="padding: 10px;">
                        <strong>${data.name}</strong><br/>
                        ROI: <span style="color: ${data.value >= 0 ? '#10b981' : '#ef4444'}">${data.value.toFixed(1)}%</span><br/>
                        退款率: ${refundRate.toFixed(1)}%<br/>
                        净收益: ${data.value >= 0 ? '盈利' : '亏损'}
                    </div>`;
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: roiData.map(d => d.name),
                axisLabel: {
                    interval: 0,
                    rotate: 45
                }
            },
            yAxis: {
                type: 'value',
                name: 'ROI (%)',
                axisLabel: {
                    formatter: '{value}%'
                }
            },
            series: [{
                name: 'ROI',
                type: 'bar',
                data: roiData.map(d => ({
                    value: d.value,
                    itemStyle: {
                        color: d.value >= 0 ?
                            (d.value > 30 ? '#10b981' : '#f59e0b') :
                            '#ef4444'
                    }
                })),
                label: {
                    show: true,
                    position: 'top',
                    formatter: '{c}%'
                }
            }]
        };

        roiChart.setOption(option);

        // 响应式处理
        window.addEventListener('resize', function() {
            roiChart.resize();
        });
    </script>
</body>
</html>