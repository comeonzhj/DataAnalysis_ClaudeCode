<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>细分群体识别 - 高价值用户群体特征</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body class="slide-page">
    <div class="slide">
        <div class="slide-header">
            <h1 class="slide-title">细分群体识别</h1>
            <p class="slide-subtitle">高价值用户群体特征与分层分析</p>
        </div>

        <div class="slide-content">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                <div class="content-section">
                    <h2 class="section-title">用户价值分层</h2>
                    <div class="chart-container" id="userSegmentChart" style="height: 350px;"></div>
                </div>

                <div class="content-section">
                    <h2 class="section-title">高价值TOP10细分群体</h2>
                    <div class="chart-container" id="highValueChart" style="height: 350px;"></div>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">高价值群体特征</h3>
                <div class="metrics-grid" style="grid-template-columns: repeat(4, 1fr);">
                    <div class="metric-card">
                        <div class="metric-value">39个</div>
                        <div class="metric-label">高价值细分群体</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">1499%</div>
                        <div class="metric-label">最高ROI</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">¥1033</div>
                        <div class="metric-label">最高平均订单额</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">42%</div>
                        <div class="metric-label">重要保持用户占比</div>
                    </div>
                </div>
            </div>

            <div class="content-section">
                <h3 class="section-title">关键洞察</h3>
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-icon">👑</div>
                        <div class="insight-content">
                            <h4>重要价值用户最稀缺</h4>
                            <p>仅占3%但客单价高达352元，是重点维护对象</p>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🎯</div>
                        <div class="insight-content">
                            <h4>北京地区高价值群体集中</h4>
                            <p>问题商品+免邮券组合ROI达1499%，远超其他地区</p>
                        </div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">📈</div>
                        <div class="insight-content">
                            <h4>类别1商品表现优异</h4>
                            <p>多数高价值群体集中在类别1商品，平均ROI超过400%</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script>
        // 用户价值分层图表
        const userSegmentChart = echarts.init(document.getElementById('userSegmentChart'));

        const segmentData = [
            { name: '重要保持用户', value: 42.0, avgOrder: 165.6, refundRate: 51.6 },
            { name: '重要挽留用户', value: 41.6, avgOrder: 163.2, refundRate: 53.2 },
            { name: '重要发展用户', value: 13.4, avgOrder: 290.4, refundRate: 60.2 },
            { name: '重要价值用户', value: 3.0, avgOrder: 352.4, refundRate: 53.3 }
        ];

        const segmentOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params) {
                    const data = params[0];
                    const segment = segmentData.find(d => d.name === data.name);
                    return `
                        <div style="padding: 10px;">
                            <strong>${data.name}</strong><br/>
                            用户占比: ${data.value}%<br/>
                            平均订单额: ¥${segment.avgOrder}<br/>
                            退款率: ${segment.refundRate}%
                        </div>
                    `;
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                name: '用户占比 (%)'
            },
            yAxis: {
                type: 'category',
                data: segmentData.map(d => d.name),
                axisLabel: {
                    interval: 0
                }
            },
            series: [{
                name: '用户占比',
                type: 'bar',
                data: segmentData.map(d => ({
                    value: d.value,
                    itemStyle: {
                        color: d.value > 30 ? '#10b981' :
                               d.value > 10 ? '#f59e0b' : '#3b82f6'
                    }
                })),
                label: {
                    show: true,
                    position: 'right',
                    formatter: '{c}%'
                }
            }]
        };

        userSegmentChart.setOption(segmentOption);

        // 高价值TOP10细分群体图表
        const highValueChart = echarts.init(document.getElementById('highValueChart'));

        const topSegments = [
            { userLevel: '重要挽留', region: '北京', category: '问题商品', roi: 1499.1, avgOrder: 1032.7 },
            { userLevel: '重要发展', region: '广西', category: '类别1', roi: 851.7, avgOrder: 317.2 },
            { userLevel: '重要价值', region: '山西', category: '类别1', roi: 618.2, avgOrder: 303.5 },
            { userLevel: '重要价值', region: '北京', category: '类别1', roi: 576.6, avgOrder: 188.4 },
            { userLevel: '重要发展', region: '上海', category: '类别1', roi: 549.1, avgOrder: 238.0 },
            { userLevel: '重要发展', region: '河北', category: '类别1', roi: 515.3, avgOrder: 203.9 },
            { userLevel: '重要发展', region: '陕西', category: '类别1', roi: 489.8, avgOrder: 157.3 },
            { userLevel: '重要发展', region: '浙江', category: '类别1', roi: 418.4, avgOrder: 117.8 },
            { userLevel: '重要价值', region: '贵州', category: '类别1', roi: 405.9, avgOrder: 202.9 },
            { userLevel: '重要挽留', region: '山东', category: '类别1', roi: 377.8, avgOrder: 143.3 }
        ];

        const highValueOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params) {
                    const data = params[0];
                    const segment = topSegments[data.dataIndex];
                    return `
                        <div style="padding: 10px;">
                            <strong>${segment.region} - ${segment.category}</strong><br/>
                            用户层级: ${segment.userLevel}<br/>
                            ROI: ${segment.roi}%<br/>
                            平均订单额: ¥${segment.avgOrder}
                        </div>
                    `;
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                name: 'ROI (%)'
            },
            yAxis: {
                type: 'category',
                data: topSegments.map((d, i) => `${i + 1}. ${d.region}`),
                axisLabel: {
                    interval: 0
                }
            },
            series: [{
                name: 'ROI',
                type: 'bar',
                data: topSegments.map(d => ({
                    value: d.roi,
                    itemStyle: {
                        color: d.roi > 1000 ? '#10b981' :
                               d.roi > 500 ? '#f59e0b' :
                               d.roi > 300 ? '#f97316' : '#ef4444'
                    }
                })),
                label: {
                    show: true,
                    position: 'right',
                    formatter: '{c}%'
                }
            }]
        };

        highValueChart.setOption(highValueOption);

        // 响应式处理
        window.addEventListener('resize', function() {
            userSegmentChart.resize();
            highValueChart.resize();
        });
    </script>
</body>
</html>